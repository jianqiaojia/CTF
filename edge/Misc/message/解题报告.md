# CTF Misc 题目解题报告 - message.png

## 题目信息

- **题目名称**: message.png 隐写分析
- **题目类型**: Misc / 隐写术
- **Flag格式**: EdgeCTF{random_string_here}

## 题目描述

在桌面上发现了一张图片，看起来像是个空白消息模板，但可能隐藏了一些内容。

## 解题过程

### 1. 初步分析

首先查看文件基本信息：
```
文件名: message.png
文件大小: 721,732 字节 (约 705 KB)
```

对于一个"空白消息模板"来说，这个文件大小显得异常大，暗示文件中可能包含额外的数据。

### 2. PNG 文件结构分析

编写 Python 脚本分析 PNG 文件的 chunk 结构：

```python
# 主要发现的 chunks:
- IHDR: 图像头信息
- pHYs: 物理像素尺寸
- iCCP: 颜色配置文件 (2,639 字节)
- iTXt: 国际化文本数据 (17,113 字节) ← 重点！
- cHRM: 色度信息
- IDAT: 图像数据 (701,834 字节)
- IEND: 文件结束标记
```

### 3. 关键发现

在 **iTXt chunk** 中发现了大量的 Adobe XMP 元数据（17KB），这是 Photoshop 等专业图像编辑软件保存的额外信息。

通过搜索关键字 "EdgeCTF"，在文件偏移 4045 字节处找到：

```xml
<photoshop:LayerName>EdgeCTF{Hey_th3re_y0u_f0und_m3}</photoshop:LayerName>
```

### 4. 技术原理

这道题目使用了 **元数据隐写** 技术：

- PNG 文件支持多种辅助数据块（chunk），包括 tEXt、zTXt、iTXt 等文本类型
- Adobe Photoshop 在保存 PNG 时会将图层信息、编辑历史等元数据嵌入到 iTXt chunk 中
- 这些元数据在图片正常显示时是不可见的，但可以通过分析文件结构提取
- 出题者巧妙地将 flag 隐藏在 Photoshop 的图层名称（LayerName）字段中

## 答案

**Flag: `EdgeCTF{Hey_th3re_y0u_f0und_m3}`**

## 使用的工具和技术

1. **PowerShell** - 查看文件基本信息
2. **Python** - 编写自定义脚本分析 PNG 文件结构
3. **PNG 格式知识** - 理解 chunk 结构和各种辅助数据块
4. **XMP 元数据** - Adobe 的可扩展元数据平台

## 学习要点

1. **文件大小异常**往往是隐写的第一个线索
2. **元数据隐写**是一种常见的 CTF 隐写技巧，需要了解各种文件格式的元数据结构
3. PNG 文件除了图像数据外，还可以包含大量的辅助信息
4. 专业图像编辑软件（如 Photoshop、GIMP）会在文件中保存详细的编辑历史和图层信息
5. 对于图片类题目，除了 LSB、文件尾部追加数据等常见方法，也要注意检查元数据

## 相关工具推荐

- **exiftool** - 查看和编辑图片元数据
- **binwalk** - 分析文件结构和嵌入文件
- **strings** - 提取文件中的可读字符串
- **zsteg** - PNG/BMP 隐写分析工具
- **stegsolve** - 多功能图像隐写分析工具

## 总结

这是一道考察对图片文件结构和元数据理解的题目。flag 并没有使用复杂的加密或编码，而是直接存储在图片的元数据中。关键是要知道去哪里找，以及如何提取这些"隐藏"的信息。